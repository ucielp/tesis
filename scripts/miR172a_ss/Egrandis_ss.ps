%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.1
%%CreationDate: Fri Jan 15 12:00:28 2016
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
AAUCCAAGCUGGAUCAGUACGCCUUUACAGUCGUCGGUUGCAGGCGUAGCAUCAUCAAGAUUCACAAGUGAAAUGGACGGCGAUGAUGGAUCGCGCCAAAGUCAUCUGAGAUUGAGAAUCUUGAUGAUGCUGCAUCGGCAAUAAACGACUCUACACGACACUCGAGGUCCCUCUUCUUUGCUUUCUG\
) def
/coor [
[110.19191742 564.21472168]
[97.02916718 556.30035400]
[89.60113525 542.85711670]
[89.90591431 527.50128174]
[97.86152649 514.36340332]
[111.32794952 506.97753906]
[111.57859802 491.97961426]
[111.82923889 476.98171997]
[112.07988739 461.98382568]
[102.74278259 447.13497925]
[112.31996918 431.41809082]
[112.31996918 416.41809082]
[112.31996918 401.41809082]
[101.63909912 391.10040283]
[101.42541504 375.88827515]
[112.31996918 364.75515747]
[112.31996918 349.75515747]
[102.01598358 341.99917603]
[98.00660706 329.53671265]
[101.97138214 316.85586548]
[112.67481232 308.66000366]
[112.92545319 293.66207886]
[113.17610168 278.66418457]
[113.42675018 263.66629028]
[113.67739868 248.66836548]
[112.67550659 233.70187378]
[110.42807007 218.87118530]
[100.87120056 207.44685364]
[106.45349121 192.64318848]
[104.20605469 177.81251526]
[101.95861816 162.98182678]
[99.71118164 148.15115356]
[97.46374512 133.32048035]
[95.21630859 118.48979950]
[83.61379242 109.81063080]
[81.44284058 95.48467255]
[89.95301056 83.75763702]
[87.70557404 68.92696381]
[85.45813751 54.09628296]
[83.21070099 39.26560211]
[80.96326447 24.43492508]
[71.24563599 11.94980240]
[76.98868561 -1.79307544]
[74.74124908 -16.62375450]
[65.02362061 -29.10887718]
[70.76666260 -42.85175323]
[68.51922607 -57.68243408]
[66.27178955 -72.51311493]
[64.02436066 -87.34378815]
[61.77692032 -102.17446899]
[59.52948380 -117.00514984]
[57.28204727 -131.83583069]
[55.03461456 -146.66650391]
[52.78717804 -161.49717712]
[50.53974152 -176.32786560]
[48.29230499 -191.15853882]
[46.04486847 -205.98922729]
[43.79743195 -220.81990051]
[41.54999542 -235.65057373]
[39.30255890 -250.48126221]
[37.05512238 -265.31192017]
[34.80768967 -280.14260864]
[32.56025314 -294.97329712]
[22.84262276 -307.45840454]
[28.58566856 -321.20129395]
[26.33823395 -336.03198242]
[24.09079742 -350.86264038]
[9.18570423 -353.37176514]
[-4.19595242 -360.35559082]
[-14.74948883 -371.11901855]
[-21.45034981 -384.59912109]
[-23.65356636 -399.47018433]
[-21.15582085 -414.27398682]
[-14.21413136 -427.56280518]
[-3.51947451 -438.04110718]
[9.87198257 -444.69165039]
[7.62454605 -459.52233887]
[5.37711000 -474.35299683]
[2.75867462 -489.12268066]
[-0.22911520 -503.82211304]
[-3.21690488 -518.52154541]
[-6.20469475 -533.22094727]
[-10.98960304 -541.02575684]
[-9.11743641 -548.19091797]
[-11.85918427 -562.93817139]
[-14.60093212 -577.68548584]
[-25.66371727 -589.79113770]
[-20.45403481 -605.34075928]
[-4.33115911 -608.33825684]
[6.11907673 -595.70007324]
[0.14636631 -580.42724609]
[2.88811421 -565.67993164]
[5.62986183 -550.93261719]
[8.49473095 -536.20874023]
[11.48252106 -521.50933838]
[14.47031021 -506.80990601]
[17.45809937 -492.11047363]
[20.20019531 -489.86416626]
[21.98142242 -486.16940308]
[22.12902641 -481.49661255]
[20.20778847 -476.60043335]
[22.45522499 -461.76977539]
[24.70266151 -446.93908691]
[39.46327209 -444.55468750]
[52.78222656 -437.71542358]
[63.34940720 -427.07986450]
[70.12100983 -413.68075562]
[72.42264557 -398.82461548]
[70.01646423 -383.96441650]
[63.12569427 -370.55749512]
[52.41397476 -359.92257690]
[38.92147446 -353.11007690]
[41.16891098 -338.27941895]
[43.41634750 -323.44873047]
[52.97322464 -312.02438354]
[47.39093018 -297.22073364]
[49.63836670 -282.39004517]
[51.88580322 -267.55935669]
[54.13323975 -252.72869873]
[56.38067627 -237.89801025]
[58.62811279 -223.06733704]
[60.87554550 -208.23664856]
[63.12298203 -193.40597534]
[65.37042236 -178.57530212]
[67.61785889 -163.74461365]
[69.86528778 -148.91394043]
[72.11272430 -134.08326721]
[74.36016083 -119.25258636]
[76.60759735 -104.42190552]
[78.85503387 -89.59122467]
[81.10247040 -74.76055145]
[83.34990692 -59.92987061]
[85.59734344 -45.09918976]
[95.15422058 -33.67485809]
[89.57192993 -18.87119102]
[91.81936646 -4.04051161]
[101.37623596 7.38382149]
[95.79394531 22.18748856]
[98.04138184 37.01816559]
[100.28881836 51.84884644]
[102.53625488 66.67952728]
[104.78369141 81.51020050]
[116.38620758 90.18936920]
[118.55715942 104.51532745]
[110.04698944 116.24236298]
[112.29442596 131.07304382]
[114.54186249 145.90371704]
[116.78929901 160.73439026]
[119.03673553 175.56507874]
[121.28417206 190.39575195]
[131.00180054 202.88087463]
[125.25875092 216.62374878]
[127.50618744 231.45443726]
[134.61456299 218.24569702]
[147.31637573 210.26670837]
[162.30140686 209.59687805]
[175.66445923 216.41076660]
[183.92298889 228.93260193]
[184.92477417 243.89912415]
[178.40873718 257.40991211]
[166.07301331 265.94393921]
[151.13238525 267.27719116]
[137.48049927 261.06219482]
[128.67530823 248.91902161]
[128.42465210 263.91693115]
[128.17401123 278.91482544]
[127.92336273 293.91275024]
[127.67271423 308.91064453]
[140.05943298 321.24984741]
[139.70663452 338.39257812]
[127.31996918 349.75515747]
[127.31996918 364.75515747]
[138.21452332 375.88827515]
[138.00083923 391.10040283]
[127.31996918 401.41809082]
[127.31996918 416.41809082]
[127.31996918 431.41809082]
[135.87841797 441.08511353]
[135.55841064 453.59112549]
[127.07779694 462.23446655]
[126.82714844 477.23236084]
[126.57649994 492.23028564]
[126.32585144 507.22817993]
[139.53796387 515.05987549]
[147.05012512 528.45629883]
[146.84161377 543.81378174]
[138.96852112 557.00122070]
] def
/pairs [
[6 183]
[7 182]
[8 181]
[9 180]
[11 177]
[12 176]
[13 175]
[16 172]
[17 171]
[21 168]
[22 167]
[23 166]
[24 165]
[25 164]
[26 153]
[27 152]
[29 150]
[30 149]
[31 148]
[32 147]
[33 146]
[34 145]
[37 142]
[38 141]
[39 140]
[40 139]
[41 138]
[43 136]
[44 135]
[46 133]
[47 132]
[48 131]
[49 130]
[50 129]
[51 128]
[52 127]
[53 126]
[54 125]
[55 124]
[56 123]
[57 122]
[58 121]
[59 120]
[60 119]
[61 118]
[62 117]
[63 116]
[65 114]
[66 113]
[67 112]
[76 103]
[77 102]
[78 101]
[79 97]
[80 96]
[81 95]
[82 94]
[84 93]
[85 92]
[86 91]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
