%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-2.1.1
%%CreationDate: Fri Jan 15 12:00:28 2016
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GAUCGGUCUCACAUAUCAAGACCAUGUGCUGAUCAACAGUUGUUGUUUGCGGCUGUAGCAUCAUGAAGAUUCACACAUGCAAAUGCAACUCAAACUCUCCCAUAGUUGUUUAAAGUGAGAAUCUUGAUGAUGCUGCAUCGGCAAUAAACGACUAUACAGAGGGGUUUAUGUUUAGACAAA\
) def
/coor [
[82.55405426 138.23448181]
[73.99192810 150.55073547]
[65.42979431 162.86697388]
[56.86766815 175.18322754]
[48.30553818 187.49948120]
[39.74340820 199.81571960]
[39.30607986 205.07133484]
[37.10259628 209.20776367]
[33.86196136 211.73698425]
[30.40123558 212.53433228]
[21.20968628 224.38824463]
[12.01813793 236.24217224]
[2.82658982 248.09608459]
[-6.36495876 259.95001221]
[-1.12277102 274.45941162]
[-4.57941580 289.49453735]
[-15.63189030 300.25775146]
[-30.75338936 303.31451416]
[-45.11869812 297.68942261]
[-54.14390182 285.17745972]
[-54.94908524 269.77111816]
[-47.27732086 256.38653564]
[-33.57663727 249.29463196]
[-18.21887970 250.75845337]
[-9.02733135 238.90454102]
[0.16421758 227.05061340]
[9.35576630 215.19670105]
[18.54731369 203.34277344]
[27.42716217 191.25360107]
[35.98929214 178.93734741]
[44.55141830 166.62109375]
[53.11354828 154.30485535]
[61.67567825 141.98860168]
[70.23780823 129.67236328]
[58.78360748 108.21254730]
[61.13766098 84.00138855]
[76.51131439 65.15005493]
[99.75411224 57.97409821]
[102.34458923 43.19947433]
[104.93506622 28.42485428]
[107.52554321 13.65023327]
[110.11602020 -1.12438750]
[112.70649719 -15.89900875]
[115.29697418 -30.67362976]
[106.48879242 -43.52095032]
[109.32637787 -58.46761322]
[121.62860870 -66.78569794]
[124.21908569 -81.56031799]
[126.80956268 -96.33493805]
[129.40003967 -111.10956573]
[124.16226959 -126.03860474]
[133.98129272 -137.23841858]
[128.74351501 -152.16746521]
[138.56254578 -163.36729431]
[141.15301514 -178.14190674]
[143.74349976 -192.91653442]
[146.33396912 -207.69114685]
[148.92445374 -222.46577454]
[151.51492310 -237.24038696]
[154.10540771 -252.01501465]
[156.69587708 -266.78964233]
[159.28636169 -281.56427002]
[161.87683105 -296.33886719]
[164.46731567 -311.11349487]
[159.22953796 -326.04254150]
[169.04856873 -337.24237061]
[171.63903809 -352.01696777]
[174.22952271 -366.79159546]
[176.81999207 -381.56622314]
[179.41047668 -396.34085083]
[182.00094604 -411.11547852]
[184.59143066 -425.89007568]
[179.35365295 -440.81912231]
[189.17266846 -452.01895142]
[191.76315308 -466.79357910]
[194.35362244 -481.56820679]
[183.55624390 -487.81204224]
[175.21936035 -497.05624390]
[170.14019775 -508.39434814]
[168.79753113 -520.72070312]
[171.30656433 -532.83850098]
[177.40927124 -543.57568359]
[186.50079346 -551.89855957]
[197.68934631 -557.01116943]
[209.88375854 -558.43151855]
[213.23970032 -573.05126953]
[216.59564209 -587.67108154]
[219.95158386 -602.29083252]
[223.30752563 -616.91058350]
[226.66346741 -631.53039551]
[214.46434021 -640.64636230]
[207.03332520 -653.93920898]
[205.65792847 -669.10589600]
[210.57643127 -683.51867676]
[220.93666077 -694.68041992]
[234.94366455 -700.65734863]
[250.17063904 -700.41394043]
[263.97940063 -693.99224854]
[273.97753906 -682.50500488]
[278.43276978 -667.94232178]
[276.57321167 -652.82739258]
[268.72106934 -639.77886963]
[256.23675537 -631.05755615]
[241.28324890 -628.17443848]
[237.92730713 -613.55462646]
[234.57136536 -598.93487549]
[231.21542358 -584.31512451]
[227.85948181 -569.69537354]
[224.50354004 -555.07556152]
[238.70826721 -544.57586670]
[246.93061829 -528.88250732]
[247.48081970 -511.12133789]
[240.20245361 -494.85272217]
[226.51306152 -483.35803223]
[209.12825012 -478.97772217]
[206.53776550 -464.20309448]
[203.94729614 -449.42846680]
[209.37036133 -435.55621338]
[199.36604309 -423.29962158]
[196.77557373 -408.52499390]
[194.18508911 -393.75036621]
[191.59461975 -378.97573853]
[189.00413513 -364.20111084]
[186.41366577 -349.42651367]
[183.82318115 -334.65188599]
[189.24624634 -320.77963257]
[179.24192810 -308.52301025]
[176.65145874 -293.74841309]
[174.06097412 -278.97378540]
[171.47050476 -264.19915771]
[168.88002014 -249.42453003]
[166.28955078 -234.64991760]
[163.69906616 -219.87528992]
[161.10859680 -205.10067749]
[158.51811218 -190.32604980]
[155.92764282 -175.55143738]
[153.33715820 -160.77680969]
[158.76022339 -146.90455627]
[148.75592041 -134.64794922]
[154.17898560 -120.77568817]
[144.17466736 -108.51908875]
[141.58418274 -93.74446106]
[138.99371338 -78.96984100]
[136.40322876 -64.19522095]
[145.14176941 -52.18799591]
[142.72512817 -37.16752625]
[130.07159424 -28.08315277]
[127.48112488 -13.30853176]
[124.89064789 1.46608961]
[122.30017090 16.24071121]
[119.70969391 31.01533127]
[117.11921692 45.78995132]
[114.52873230 60.56457520]
[122.21885681 64.32704926]
[128.98695374 69.56985474]
[134.55216980 76.07543182]
[138.68354797 83.57381439]
[141.20968628 91.75383759]
[142.02571106 100.27605438]
[141.09779358 108.78681946]
[138.46443176 116.93295288]
[134.23487854 124.37641144]
[128.58468628 130.80831909]
[121.74830627 135.96176147]
[127.09545135 149.97631836]
[132.44261169 163.99089050]
[137.78976440 178.00544739]
[143.13690186 192.02001953]
[156.19496155 201.94067383]
[153.86428833 218.17335510]
[138.54249573 224.01927185]
[125.99132538 213.46464539]
[129.12234497 197.36715698]
[123.77519226 183.35260010]
[118.42804718 169.33804321]
[113.08089447 155.32347107]
[107.73374176 141.30891418]
[102.62267303 141.94470215]
[97.47222137 141.95053101]
[92.35972595 141.32630920]
] def
/pairs [
[1 34]
[2 33]
[3 32]
[4 31]
[5 30]
[6 29]
[10 28]
[11 27]
[12 26]
[13 25]
[14 24]
[38 153]
[39 152]
[40 151]
[41 150]
[42 149]
[43 148]
[44 147]
[47 144]
[48 143]
[49 142]
[50 141]
[52 139]
[54 137]
[55 136]
[56 135]
[57 134]
[58 133]
[59 132]
[60 131]
[61 130]
[62 129]
[63 128]
[64 127]
[66 125]
[67 124]
[68 123]
[69 122]
[70 121]
[71 120]
[72 119]
[74 117]
[75 116]
[76 115]
[85 109]
[86 108]
[87 107]
[88 106]
[89 105]
[90 104]
[164 177]
[165 176]
[166 175]
[167 174]
[168 173]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
